{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje izvršavanje shell komandi u production containerima putem Falco runtime detection.","enabled":true,"false_positives":[],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Shell Execution in Production Container","query":"event.dataset:falco AND priority:Critical AND rule:*shell*","references":["https://attack.mitre.org/techniques/T1059/"],"risk_score":90,"rule_id":"falco-shell-execution-001","severity":"critical","tags":["Semaphore","Falco","Runtime Security","MITRE ATT&CK T1059"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002/"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059/"}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"falco-shell-execution-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje pokušaje pristupa Kubernetes secret resursima koji nisu autorizovani.","enabled":true,"false_positives":[],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Unauthorized Secret Access","query":"event.dataset:falco AND (rule:*secret* OR kubernetes.audit.objectRef.resource:secrets) AND kubernetes.audit.responseStatus.code:[401 TO 403]","references":["https://attack.mitre.org/techniques/T1552/007/"],"risk_score":95,"rule_id":"k8s-secret-access-001","severity":"critical","tags":["Semaphore","Kubernetes","Secrets","MITRE ATT&CK T1552.007"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1552","name":"Unsecured Credentials","reference":"https://attack.mitre.org/techniques/T1552/","subtechnique":[{"id":"T1552.007","name":"Container API","reference":"https://attack.mitre.org/techniques/T1552/007/"}]}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"k8s-secret-access-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje više neuspješnih login pokušaja što može ukazivati na brute force attack.","enabled":true,"false_positives":["Korisnik koji je zaboravio password"],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Brute Force Authentication Attempts","query":"http.response.status_code:401 AND source.ip:*","references":["https://attack.mitre.org/techniques/T1110/"],"risk_score":70,"rule_id":"auth-brute-force-001","severity":"high","tags":["Semaphore","Authentication","Brute Force","MITRE ATT&CK T1110"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1110","name":"Brute Force","reference":"https://attack.mitre.org/techniques/T1110/"}]}],"throttle":"no_actions","threshold":{"field":["source.ip"],"value":10},"timestamp_override":"event.ingested","to":"now","type":"threshold","version":1},"id":"auth-brute-force-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje pokušaje privilege escalation kroz Falco runtime detection pravila.","enabled":true,"false_positives":[],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Privilege Escalation Attempt","query":"event.dataset:falco AND priority:(Critical OR Warning) AND (rule:*privilege* OR rule:*setuid* OR rule:*sudo*)","references":["https://attack.mitre.org/tactics/TA0004/"],"risk_score":95,"rule_id":"falco-privesc-001","severity":"critical","tags":["Semaphore","Falco","Privilege Escalation","MITRE ATT&CK TA0004"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004/"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548/"}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"falco-privesc-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje česte pod restartove što može ukazivati na security incident, exploit attempt ili crash loop.","enabled":true,"false_positives":["Deployment updates","Legitimate OOM kills"],"from":"now-15m","interval":"5m","language":"kuery","max_signals":100,"name":"Suspicious Pod Restart Activity","query":"kubernetes.pod.name:* AND event.reason:*Restart*","references":[],"risk_score":60,"rule_id":"k8s-pod-restart-001","severity":"medium","tags":["Semaphore","Kubernetes","Availability","Forensics"],"throttle":"no_actions","threshold":{"field":["kubernetes.pod.name"],"value":5},"timestamp_override":"event.ingested","to":"now","type":"threshold","version":1},"id":"k8s-pod-restart-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje unauthorized network konekcije koje krše definisane NetworkPolicies.","enabled":true,"false_positives":[],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Network Policy Violation","query":"event.dataset:falco AND rule:*network* AND priority:(Critical OR Warning)","references":["https://attack.mitre.org/tactics/TA0011/"],"risk_score":75,"rule_id":"falco-network-violation-001","severity":"high","tags":["Semaphore","Falco","Network Security","MITRE ATT&CK TA0011"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011/"},"technique":[{"id":"T1071","name":"Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1071/"}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"falco-network-violation-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje pristup sensitive fajlovima kao što su /etc/shadow, /etc/passwd, SSH keys, i Kubernetes service account tokens.","enabled":true,"false_positives":[],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"Sensitive File Access","query":"event.dataset:falco AND (fd.name:(\"/etc/shadow\" OR \"/etc/passwd\" OR \"*/.ssh/*\" OR \"*/serviceaccount/token\")) AND priority:(Critical OR Warning)","references":["https://attack.mitre.org/techniques/T1552/001/"],"risk_score":85,"rule_id":"falco-sensitive-file-001","severity":"high","tags":["Semaphore","Falco","File System","MITRE ATT&CK T1552.001"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006/"},"technique":[{"id":"T1552","name":"Unsecured Credentials","reference":"https://attack.mitre.org/techniques/T1552/","subtechnique":[{"id":"T1552.001","name":"Credentials In Files","reference":"https://attack.mitre.org/techniques/T1552/001/"}]}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"falco-sensitive-file-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
{"attributes":{"actions":[],"author":["Semaphore Security Team"],"description":"Detektuje kreiranje ili modifikaciju RBAC resursa (Roles, RoleBindings) što može biti pokušaj persistence ili privilege escalation.","enabled":true,"false_positives":["Legitimate admin operations"],"from":"now-5m","interval":"5m","language":"kuery","max_signals":100,"name":"RBAC Role Modification","query":"kubernetes.audit.objectRef.resource:(roles OR rolebindings OR clusterroles OR clusterrolebindings) AND kubernetes.audit.verb:(create OR update OR patch)","references":["https://attack.mitre.org/techniques/T1098/"],"risk_score":80,"rule_id":"k8s-rbac-modification-001","severity":"high","tags":["Semaphore","Kubernetes","RBAC","MITRE ATT&CK T1098"],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003/"},"technique":[{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098/"}]}],"throttle":"no_actions","timestamp_override":"event.ingested","to":"now","type":"query","version":1},"id":"k8s-rbac-modification-001","migrationVersion":{"alert":"7.16.0"},"references":[],"type":"alert"}
